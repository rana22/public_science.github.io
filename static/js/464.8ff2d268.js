"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[464],{30464:(e,t,n)=>{n.r(t),n.d(t,{default:()=>he});var l=n(96540),a=n(44015),o=n(70713),r=n(32255),c=n(73639),i=n(17681),s=n(44877),d=n(7562),m=n(16718);const u=(0,s.makeStyles)()((e=>({fab:{position:"absolute",bottom:e.spacing(6),right:e.spacing(6)}}))),g=(0,a.observer)((function({model:e}){const{classes:t}=u(),n=(0,d.getSession)(e),[a,o]=(0,l.useState)(null);function s(){o(null)}const g=(0,d.isSessionModelWithConnections)(n),k=(0,d.isSessionWithAddTracks)(n);return k||g?l.createElement(l.Fragment,null,l.createElement(r.A,{color:"secondary",className:t.fab,onClick:e=>o(e.currentTarget)},l.createElement(m.A,null)),l.createElement(c.A,{anchorEl:a,open:Boolean(a),onClose:()=>o(null)},g?l.createElement(i.A,{onClick:()=>{s(),(0,d.isSessionModelWithWidgets)(n)&&n.showWidget(n.addWidget("AddConnectionWidget","addConnectionWidget"))}},"Add connection"):null,k?l.createElement(i.A,{onClick:()=>{s(),(0,d.isSessionModelWithWidgets)(n)&&n.showWidget(n.addWidget("AddTrackWidget","addTrackWidget",{view:e.view.id}))}},"Add track"):null)):null}));var k=n(28820),h=n(33551),v=n(19455),f=n(47537),C=n.n(f),p=n(10885),b=n(60684),E=n(55044);function y(e){return"category"===(null==e?void 0:e.type)?e.children.map((e=>"category"===e.type?y(e):e.conf)).flat(1/0):[]}function A(e,t=new Map){e.id&&e.children.length&&t.set(e.id,e);for(const n of e.children)A(n,t);return t}function S(e=""){return e.endsWith("(Unsupported)")||e.endsWith("(Unknown)")}const T=(0,s.makeStyles)()((e=>({contrastColor:{color:e.palette.tertiary.contrastText},accordionText:{margin:"auto 0",width:"100%"}})));function x({isOpen:e,setOpen:t,data:n}){const{classes:a}=T(),[o,r]=(0,l.useState)(null),{menuItems:c=[],name:i,model:s,id:d,tree:m}=n;return l.createElement("div",{className:a.accordionText,onClick:()=>{o||(n.toggleCollapse(d),t(!e))}},l.createElement(h.A,null,e?l.createElement(p.default,null):l.createElement(b.default,null),i,l.createElement(v.A,{onClick:e=>{r(e.currentTarget),e.stopPropagation()},className:a.contrastColor},l.createElement(E.A,null))),o?l.createElement(C(),{anchorEl:o,menuItems:[{label:"Add to selection",onClick:()=>{const e=A(m).get(d);s.addToSelection(y(e))}},{label:"Remove from selection",onClick:()=>{const e=A(m).get(d);s.removeFromSelection(y(e))}},{label:"Show all tracks",onClick:()=>{var e;for(const t of(null===(e=A(m).get(d))||void 0===e?void 0:e.children)||[])"track"===t.type&&s.view.showTrack(t.trackId)}},{label:"Hide all tracks",onClick:()=>{var e;for(const t of(null===(e=A(m).get(d))||void 0===e?void 0:e.children)||[])"track"===t.type&&s.view.hideTrack(t.trackId)}},...c],onMenuItemClick:(e,t)=>{t(),r(null)},open:Boolean(o),onClose:()=>r(null)}):null)}var M=n(56655),W=n(1775),w=n(71238),I=n(6096),L=n.n(I),F=n(92168),N=n(8810);const O=(0,s.makeStyles)()((e=>({compactCheckbox:{padding:0},checkboxLabel:{marginRight:0,"&:hover":{backgroundColor:e.palette.action.selected}},selected:{background:"#cccc"}})));function z({data:e}){const{classes:t}=O(),{checked:n,conf:a,model:o,drawerPosition:r,id:c,trackId:i,name:s,onChange:d,selected:m}=e,u=a&&(0,F.readConfObject)(a,"description")||"";return l.createElement(l.Fragment,null,l.createElement(M.A,{title:u+(m?" (in selection)":""),placement:"left"===r?"right":"left"},l.createElement(W.A,{className:t.checkboxLabel,control:l.createElement(w.A,{className:t.compactCheckbox,checked:n,onChange:()=>d(i),disabled:S(s),inputProps:{"data-testid":`htsTrackEntry-${c}`}}),label:l.createElement("div",{"data-testid":`htsTrackLabel-${c}`,style:{background:m?"#cccc":void 0}},l.createElement(L(),{html:s}))})),l.createElement(N.A,{model:o,trackId:i,id:c,conf:a}))}const H=(0,s.makeStyles)()((e=>({accordionBase:{display:"flex"},accordionCard:{padding:3,cursor:"pointer",display:"flex"},nestingLevelMarker:{position:"absolute",borderLeft:"1.5px solid #555"},accordionColor:{background:e.palette.tertiary.main,color:e.palette.tertiary.contrastText,width:"100%",display:"flex",paddingLeft:5}})));function B({data:e,isOpen:t,style:n,setOpen:a}){const{isLeaf:o,nestingLevel:r}=e,{classes:c}=H(),i=10*r+(o?10:0);return l.createElement("div",{style:n,className:o?void 0:c.accordionBase},new Array(r).fill(0).map(((e,t)=>l.createElement("div",{key:`mark-${t}`,style:{left:10*t+4,height:null==n?void 0:n.height},className:c.nestingLevelMarker}))),l.createElement("div",{className:o?void 0:c.accordionCard,style:{marginLeft:i,whiteSpace:"nowrap",width:"100%"}},l.createElement("div",{className:o?void 0:c.accordionColor},o?l.createElement(z,{data:e}):l.createElement(x,{isOpen:t,data:e,setOpen:a}))))}function j(e,t,n,l){const a="track"===e.type;return{data:{defaultHeight:a?22:40,isLeaf:a,isOpenByDefault:!0,nestingLevel:t,selected:!!a&&l[e.trackId],...e,...n},nestingLevel:t,node:e}}const R=(0,a.observer)((function({height:e,tree:t,model:n}){const{filterText:a,selection:o,view:r}=n,c=(0,l.useRef)(null),i=(0,d.getSession)(n),{drawerPosition:s}=i,m=(0,l.useMemo)((()=>Object.fromEntries(o.map((e=>[e.trackId,e])))),[o]),u=(0,l.useMemo)((()=>({onChange:e=>{r.toggleTrack(e)&&n.addToRecentlyUsed(e)},toggleCollapse:e=>n.toggleCategory(e),tree:t,model:n,drawerPosition:s})),[r,n,s,t]),g=(0,l.useCallback)((function*(){for(const e of t.children)yield j(e,0,u,m);for(;;){const e=yield;for(const t of e.node.children)yield j(t,e.nestingLevel+1,u,m)}}),[t,u,m]);return(0,l.useEffect)((()=>{c.current.recomputeTree({refreshNodes:!0,useDefaultHeight:!0})}),[t,a]),l.createElement(l.Fragment,null,l.createElement(k.VariableSizeTree,{ref:c,treeWalker:g,height:e},B))}));var D=n(1043),P=n(29153),U=n(12092),$=n(22586),_=n.n($),V=n(62274);const G=(0,l.lazy)((()=>n.e(4615).then(n.bind(n,4615)))),q=(0,l.lazy)((()=>n.e(1129).then(n.bind(n,41129)))),J=(0,l.lazy)((()=>n.e(4194).then(n.bind(n,74194)))),K=(0,l.lazy)((()=>n.e(4617).then(n.bind(n,84617)))),Q=(0,l.lazy)((()=>n.e(2420).then(n.bind(n,92420)))),X=(0,a.observer)((function({model:e}){const t=(0,d.getSession)(e),[n,a]=(0,l.useState)(),[o,r]=(0,l.useState)(),[c,i]=(0,l.useState)(!1),[s,m]=(0,l.useState)(!1),[u,g]=(0,l.useState)(!1);function k(e,n){var l;const o=(0,F.readConfObject)(e,"name"),c=null===(l=t.prepareToBreakConnection)||void 0===l?void 0:l.call(t,e);if(c){const[t,n]=c;Object.keys(n).length>0?a({connectionConf:e,safelyBreakConnection:t,dereferenceTypeCount:n,name:o}):t()}n&&r({name:o,connectionConf:e})}return l.createElement(l.Fragment,null,l.createElement(_(),{menuItems:[{label:"Open faceted track selector",onClick:()=>{g(!0)}},...(0,d.isSessionWithAddTracks)(t)?[{label:"Add track...",onClick:()=>{(0,d.isSessionModelWithWidgets)(t)&&t.showWidget(t.addWidget("AddTrackWidget","addTrackWidget",{view:e.view.id}))}}]:[],{label:"Connections...",subMenu:[...(0,d.isSessionModelWithConnections)(t)?[{label:"Turn on/off connections...",onClick:()=>i(!0)}]:[],...(0,d.isSessionModelWithConnectionEditing)(t)?[{label:"Add connection...",onClick:()=>{(0,d.isSessionModelWithWidgets)(t)&&t.showWidget(t.addWidget("AddConnectionWidget","addConnectionWidget"))}},{label:"Delete connections...",onClick:()=>m(!0)}]:[]]},{label:"Sort...",type:"subMenu",subMenu:[{label:"Sort tracks by name",type:"checkbox",checked:e.activeSortTrackNames,onClick:()=>e.setSortTrackNames(!e.activeSortTrackNames)},{label:"Sort categories by name",type:"checkbox",checked:e.activeSortCategories,onClick:()=>e.setSortCategories(!e.activeSortCategories)}]},{label:"Collapse...",type:"subMenu",subMenu:[...e.hasAnySubcategories?[{label:"Collapse subcategories",onClick:()=>e.collapseSubCategories()}]:[],{label:"Collapse top-level categories",onClick:()=>e.collapseTopLevelCategories()},{label:"Expand all categories",onClick:()=>e.expandAllCategories()}]}]},l.createElement(V.A,null)),l.createElement(l.Suspense,{fallback:null},n?l.createElement(q,{modalInfo:n,onClose:()=>a(void 0)}):null,o?l.createElement(J,{handleClose:()=>r(void 0),deleteDialogDetails:o,session:t}):null,s?l.createElement(K,{handleClose:()=>m(!1),breakConnection:k,session:t}):null,c?l.createElement(Q,{handleClose:()=>i(!1),session:t,breakConnection:k}):null,u?l.createElement(G,{handleClose:()=>g(!1),model:e}):null))}));var Y=n(65897),Z=n(63604),ee=n(41746),te=n(92024);const ne=(0,a.observer)((function({model:e,tracks:t,extraMenuItems:n,children:a,onClick:o}){const{view:r}=e,[c,i]=(0,l.useState)(!1),s=(0,d.getSession)(e);return r?l.createElement(_(),{closeAfterItemClick:!1,onClick:o,menuItems:[...t.map((t=>({type:"checkbox",label:l.createElement(l.Fragment,null,l.createElement(L(),{html:(0,te.getTrackName)(t,s)})," ",l.createElement(N.A,{id:t.trackId,trackId:t.trackId,model:e,conf:t,setOpen:i,stopPropagation:!0})),checked:r.tracks.some((e=>e.configuration===t)),onClick:()=>{c||e.view.toggleTrack(t.trackId)&&e.addToRecentlyUsed(t.trackId)}}))),...n]},a):null})),le=(0,s.makeStyles)()({smallBadge:{height:14},margin:{marginRight:10}}),ae=(0,a.observer)((function({model:e}){const{classes:t}=le(),{view:n,favoriteTracks:a}=e;return n?l.createElement(ne,{onClick:()=>e.setFavoritesCounter(0),tracks:a,model:e,extraMenuItems:a.length?[{type:"divider"},{label:"Clear favorites",onClick:()=>e.clearFavorites()}]:[{label:"No favorite tracks yet",onClick:()=>{}}]},l.createElement(M.A,{title:"Favorite tracks"},l.createElement(Z.A,{classes:{badge:t.smallBadge},color:"secondary",anchorOrigin:{vertical:"bottom",horizontal:"right"},className:t.margin,badgeContent:e.favoritesCounter},l.createElement(ee.A,null)))):null}));var oe=n(30337);const re=(0,s.makeStyles)()({smallBadge:{height:14}}),ce=(0,a.observer)((function({model:e}){const{classes:t}=re(),{view:n,recentlyUsedCounter:a,recentlyUsedTracks:o}=e;return n?l.createElement(ne,{onClick:()=>e.setRecentlyUsedCounter(0),model:e,tracks:o,extraMenuItems:o.length?[{type:"divider"},{label:"Clear recently used",onClick:()=>e.clearRecentlyUsed()}]:[{label:"No recently used",onClick:()=>{}}]},l.createElement(M.A,{title:"Recently used tracks"},l.createElement(Z.A,{classes:{badge:t.smallBadge},anchorOrigin:{vertical:"bottom",horizontal:"right"},color:"secondary",badgeContent:a},l.createElement(oe.A,null)))):null})),ie=(0,s.makeStyles)()((e=>({searchBox:{margin:e.spacing(2)}}))),se=(0,a.observer)((function({model:e}){const{filterText:t}=e,{classes:n}=ie();return l.createElement(D.A,{className:n.searchBox,label:"Filter tracks",value:t,onChange:t=>e.setFilterText(t.target.value),fullWidth:!0,InputProps:{endAdornment:l.createElement(P.A,{position:"end"},l.createElement(v.A,{onClick:()=>e.clearFilterText()},l.createElement(U.A,null)))}})})),de=(0,a.observer)((function({model:e,setHeaderHeight:t}){return l.createElement("div",{ref:e=>t((null==e?void 0:e.getBoundingClientRect().height)||0),"data-testid":"hierarchical_track_selector"},l.createElement("div",{style:{display:"flex"}},l.createElement(X,{model:e}),l.createElement(Y.A,{model:e}),l.createElement(se,{model:e}),l.createElement(ce,{model:e}),l.createElement(ae,{model:e})))})),me=({tree:e,model:t,offset:n})=>"undefined"==typeof jest?l.createElement(o.default,{disableWidth:!0},(a=>l.createElement(R,{height:(a.height||n)-n,model:t,tree:e}))):l.createElement(R,{height:9e3,model:t,tree:e}),ue=({overrideDimensions:e,children:t})=>e?l.createElement("div",{style:{...e}},t):t,ge=(0,a.observer)((function({model:e,toolbarHeight:t,overrideDimensions:n}){return l.createElement(ue,{overrideDimensions:n},l.createElement(ke,{model:e,toolbarHeight:t}),l.createElement(g,{model:e}))})),ke=(0,a.observer)((function({model:e,toolbarHeight:t=0}){const[n,a]=(0,l.useState)(0);return l.createElement(l.Fragment,null,l.createElement(de,{model:e,setHeaderHeight:a}),l.createElement(me,{tree:e.hierarchy,model:e,offset:t+n}))})),he=ge},65897:(e,t,n)=>{n.d(t,{A:()=>d});var l=n(96540),a=n(63604),o=n(44015),r=n(7562),c=n(68311),i=n(22586),s=n.n(i);const d=(0,o.observer)((function({model:e}){const{selection:t}=e,{pluginManager:n}=(0,r.getEnv)(e),o=(0,r.getSession)(e),i=n.evaluateExtensionPoint("TrackSelector-multiTrackMenuItems",[],{session:o});return t.length?l.createElement(s(),{menuItems:[{label:"Clear",onClick:()=>e.clearSelection()},...i.map((t=>({...t,..."onClick"in t?{onClick:()=>t.onClick(e)}:{}})))]},l.createElement(a.A,{badgeContent:t.length,color:"primary"},l.createElement(c.A,null))):null}))},8810:(e,t,n)=>{n.d(t,{A:()=>u});var l=n(96540),a=n(44877),o=n(7562),r=n(22586),c=n.n(r),i=n(55044),s=n(43117),d=n(9257);const m=(0,a.makeStyles)()({cascadingStyle:{padding:0}}),u=function({id:e,trackId:t,stopPropagation:n,model:a,setOpen:r,conf:u}){var g,k;const{classes:h}=m();return l.createElement(c(),{className:h.cascadingStyle,stopPropagation:n,setOpen:r,"data-testid":`htsTrackEntryMenu-${e}`,menuItems:[...(null===(k=(g=(0,o.getSession)(a)).getTrackActionMenuItems)||void 0===k?void 0:k.call(g,u))||[],a.isFavorite(t)?{label:"Remove from favorites",onClick:()=>a.removeFromFavorites(t),icon:s.A}:{label:"Add to favorites",onClick:()=>a.addToFavorites(t),icon:d.A},{label:"Add to selection",onClick:()=>a.addToSelection([u])},...a.isSelected(u)?[{label:"Remove from selection",onClick:()=>a.removeFromSelection([u])}]:[]]},l.createElement(i.A,null))}},12092:(e,t,n)=>{var l=n(24994);t.A=void 0;var a=l(n(42032)),o=n(74848);t.A=(0,a.default)((0,o.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")},41746:(e,t,n)=>{var l=n(24994);t.A=void 0;var a=l(n(42032)),o=n(74848);t.A=(0,a.default)((0,o.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Grade")},30337:(e,t,n)=>{var l=n(24994);t.A=void 0;var a=l(n(42032)),o=n(74848);t.A=(0,a.default)((0,o.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History")},55044:(e,t,n)=>{var l=n(24994);t.A=void 0;var a=l(n(42032)),o=n(74848);t.A=(0,a.default)((0,o.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz")},68311:(e,t,n)=>{var l=n(24994);t.A=void 0;var a=l(n(42032)),o=n(74848);t.A=(0,a.default)((0,o.jsx)("path",{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2M1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2"}),"ShoppingCart")},9257:(e,t,n)=>{var l=n(24994);t.A=void 0;var a=l(n(42032)),o=n(74848);t.A=(0,a.default)((0,o.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star")},43117:(e,t,n)=>{var l=n(24994);t.A=void 0;var a=l(n(42032)),o=n(74848);t.A=(0,a.default)((0,o.jsx)("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28z"}),"StarBorderOutlined")}}]);