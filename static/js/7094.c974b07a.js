"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[7094,9846],{77094:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var s=a(11073),n=a(11375),i=a(39846);class o extends i.default{async setupPre(){const e=this.getConf("fastaLocation"),t=this.getConf("faiLocation"),a=this.getConf("gziLocation"),i={fasta:(0,n.openLocation)(e,this.pluginManager),fai:(0,n.openLocation)(t,this.pluginManager),gzi:(0,n.openLocation)(a,this.pluginManager)};return{fasta:new s.BgzipIndexedFasta(i)}}}},39846:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var s=a(11073),n=a(2340),i=a(11375),o=a(34105),r=a(7562),c=a(98802),u=a.n(c),f=a(43416);class g extends n.BaseSequenceAdapter{constructor(){super(...arguments),this.seqCache=new(u())({cache:new f.default({maxSize:200}),fill:async(e,t)=>{const{refName:a,start:s,end:n,fasta:i}=e;return i.getSequence(a,s,n,{...e,signal:t})}})}async getRefNames(e){const{fasta:t}=await this.setup();return t.getSequenceNames(e)}async getRegions(e){const{fasta:t}=await this.setup(),a=await t.getSequenceSizes(e);return Object.keys(a).map((e=>({refName:e,start:0,end:a[e]})))}async setupPre(){const e=this.getConf("fastaLocation"),t=this.getConf("faiLocation");return{fasta:new s.IndexedFasta({fasta:(0,i.openLocation)(e,this.pluginManager),fai:(0,i.openLocation)(t,this.pluginManager)})}}async getHeader(){const e=this.getConf("metadataLocation");return""===e.uri||"/path/to/fa.metadata.yaml"===e.uri?null:(0,i.openLocation)(e,this.pluginManager).readFile("utf8")}async setup(){return this.setupP||(this.setupP=this.setupPre().catch((e=>{throw this.setupP=void 0,e}))),this.setupP}getFeatures(e,t){const{refName:a,start:s,end:n}=e;return(0,o.ObservableCreate)((async e=>{const{fasta:i}=await this.setup(),o=await i.getSequenceSize(a,t),c=void 0!==o?Math.min(o,n):n,u=[],f=128e3,g=s-s%f,p=n+(f-n%f);for(let e=g;e<p;e+=f){const s={refName:a,start:e,end:e+f};u.push(this.seqCache.get(JSON.stringify(s),{...s,fasta:i},null==t?void 0:t.signal))}const h=(await Promise.all(u)).join("").slice(s-g).slice(0,n-s);h&&e.next(new r.SimpleFeature({id:`${a} ${s}-${c}`,data:{refName:a,start:s,end:c,seq:h}})),e.complete()}))}freeResources(){}}}}]);