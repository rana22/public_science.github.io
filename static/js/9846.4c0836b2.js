"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[9846],{39846:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var s=a(11073),n=a(2340),i=a(11375),r=a(34105),c=a(7562),o=a(98802),u=a.n(o),f=a(43416);class h extends n.BaseSequenceAdapter{constructor(){super(...arguments),this.seqCache=new(u())({cache:new f.default({maxSize:200}),fill:async(e,t)=>{const{refName:a,start:s,end:n,fasta:i}=e;return i.getSequence(a,s,n,{...e,signal:t})}})}async getRefNames(e){const{fasta:t}=await this.setup();return t.getSequenceNames(e)}async getRegions(e){const{fasta:t}=await this.setup(),a=await t.getSequenceSizes(e);return Object.keys(a).map((e=>({refName:e,start:0,end:a[e]})))}async setupPre(){const e=this.getConf("fastaLocation"),t=this.getConf("faiLocation");return{fasta:new s.IndexedFasta({fasta:(0,i.openLocation)(e,this.pluginManager),fai:(0,i.openLocation)(t,this.pluginManager)})}}async getHeader(){const e=this.getConf("metadataLocation");return""===e.uri||"/path/to/fa.metadata.yaml"===e.uri?null:(0,i.openLocation)(e,this.pluginManager).readFile("utf8")}async setup(){return this.setupP||(this.setupP=this.setupPre().catch((e=>{throw this.setupP=void 0,e}))),this.setupP}getFeatures(e,t){const{refName:a,start:s,end:n}=e;return(0,r.ObservableCreate)((async e=>{const{fasta:i}=await this.setup(),r=await i.getSequenceSize(a,t),o=void 0!==r?Math.min(r,n):n,u=[],f=128e3,h=s-s%f,l=n+(f-n%f);for(let e=h;e<l;e+=f){const s={refName:a,start:e,end:e+f};u.push(this.seqCache.get(JSON.stringify(s),{...s,fasta:i},null==t?void 0:t.signal))}const p=(await Promise.all(u)).join("").slice(s-h).slice(0,n-s);p&&e.next(new c.SimpleFeature({id:`${a} ${s}-${o}`,data:{refName:a,start:s,end:o,seq:p}})),e.complete()}))}freeResources(){}}}}]);