"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[2124,9607],{12124:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var r=n(96540),l=n(44015),a=n(20212),o=n(7562),i=n(44877),s=n(62516),c=n(19455),m=n(47537),d=n.n(m),u=n(5652),g=n(59849),h=n(36255),p=n(98302),E=n(90022),f=n(29898),v=n(59086),b=n(1795),k=n(54054),y=n(9607);const A=(0,i.makeStyles)()((e=>({controls:{position:"absolute",borderRight:`1px solid ${e.palette.divider}`,borderBottom:`1px solid ${e.palette.divider}`,left:0,top:0}}))),x=(0,l.observer)((function({model:e}){const{classes:t}=A(),[n,l]=(0,r.useState)(null);return r.createElement("div",{className:t.controls},r.createElement(c.A,{onClick:e.zoomOutButton,title:e.lockedFitToWindow?"unlock to zoom out":"zoom out",disabled:e.atMaxBpPerPx||e.lockedFitToWindow},r.createElement(u.A,null)),r.createElement(c.A,{onClick:e.zoomInButton,disabled:e.atMinBpPerPx,title:"zoom in"},r.createElement(g.A,null)),r.createElement(c.A,{onClick:e.rotateCounterClockwiseButton,title:"rotate counter-clockwise"},r.createElement(h.A,null)),r.createElement(c.A,{onClick:e.rotateClockwiseButton,title:"rotate clockwise"},r.createElement(p.A,null)),r.createElement(c.A,{onClick:e.toggleFitToWindowLock,title:e.lockedFitToWindow?"locked model to window size":"unlocked model to zoom further",disabled:e.tooSmallToLock},e.lockedFitToWindow?r.createElement(f.A,null):r.createElement(E.A,null)),r.createElement(c.A,{onClick:e=>l(e.currentTarget)},r.createElement(b.A,null)),e.hideTrackSelectorButton?null:r.createElement(c.A,{onClick:e.activateTrackSelector,title:"Open track selector","data-testid":"circular_track_select"},r.createElement(k.TrackSelector,null)),n?r.createElement(d(),{anchorEl:n,menuItems:[{label:"Export SVG",icon:v.A,onClick:()=>{(0,o.getSession)(e).queueDialog((t=>[y.default,{model:e,handleClose:t}]))}}],onMenuItemClick:(e,t)=>{t(),l(null)},open:Boolean(n),onClose:()=>l(null)}):null)}));var C=n(97834),S=n(99020),w=n(51629);const T=(0,i.makeStyles)()((e=>({importFormContainer:{padding:e.spacing(6)}}))),z=(0,l.observer)((({model:e})=>{const{classes:t}=T(),n=(0,o.getSession)(e),{error:l}=e,{assemblyNames:i,assemblyManager:s}=n,[c,m]=(0,r.useState)(i[0]),d=s.get(c),u=i.length?null==d?void 0:d.error:"No configured assemblies",g=(null==d?void 0:d.regions)||[],h=u||l;return r.createElement(C.A,{className:t.importFormContainer},h?r.createElement(S.Ay,{container:!0,spacing:1,justifyContent:"center",alignItems:"center"},r.createElement(S.Ay,{item:!0},r.createElement(a.ErrorMessage,{error:h}))):null,r.createElement(S.Ay,{container:!0,spacing:1,justifyContent:"center",alignItems:"center"},r.createElement(S.Ay,{item:!0},r.createElement(a.AssemblySelector,{onChange:t=>{e.setError(void 0),m(t)},session:n,selected:c})),r.createElement(S.Ay,{item:!0},r.createElement(w.A,{disabled:!(null==g?void 0:g.length),onClick:()=>{e.setError(void 0),e.setDisplayedRegions(g)},variant:"contained",color:"primary"},g.length||h?"Open":"Loading..."))))})),M=(0,i.makeStyles)()((e=>({root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},scroller:{overflow:"auto"}}))),R=(0,l.observer)((({model:e})=>r.createElement(r.Fragment,null,e.staticSlices.map((t=>r.createElement(s.A,{key:(0,o.assembleLocString)(t.region.elided?t.region.regions[0]:t.region),model:e,slice:t}))),e.tracks.map((t=>{const n=t.displays[0];return r.createElement(n.RenderingComponent,{key:n.id,display:n,view:e})}))))),P=(0,l.observer)((({model:e})=>{const t=!!e.displayedRegions.length&&!!e.figureWidth&&!!e.figureHeight&&e.initialized,n=!t&&!e.disableImportForm,l=t&&!n;return n||e.error?r.createElement(z,{model:e}):l?r.createElement(L,{model:e}):null})),L=(0,l.observer)((function({model:e}){const{width:t,height:n,id:l,offsetRadians:o,centerXY:i,figureWidth:s,figureHeight:c,hideVerticalResizeHandle:m}=e,{classes:d}=M();return r.createElement("div",{className:d.root,style:{width:t,height:n},"data-testid":l},r.createElement("div",{className:d.scroller,style:{width:t,height:n}},r.createElement("svg",{style:{transform:`rotate(${o}rad)`,transition:"transform 0.5s",transformOrigin:i.map((e=>`${e}px`)).join(" "),position:"absolute",left:0,top:0},width:s,height:c},r.createElement("g",{transform:`translate(${i})`},r.createElement(R,{model:e})))),r.createElement(x,{model:e}),m?null:r.createElement(a.ResizeHandle,{onDrag:e.resizeHeight,style:{height:3,position:"absolute",bottom:0,left:0,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}}))})),N=P},9607:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var r=n(96540),l=n(78717),a=n(33551),o=n(1043),i=n(30799),s=n(17681),c=n(1775),m=n(71238),d=n(37071),u=n(51629),g=n(20212),h=n(7562);function p(){return r.createElement("div",null,r.createElement(l.A,{size:20,style:{marginRight:20}}),r.createElement(a.A,{display:"inline"},"Creating SVG"))}function E({children:e,...t}){return r.createElement("div",null,r.createElement(o.A,{...t},e))}function f(e,t){return(0,h.useLocalStorage)("svg-"+e,t)}function v({model:e,handleClose:t}){const n=(0,h.getSession)(e),l="undefined"!=typeof OffscreenCanvas,[o,v]=(0,r.useState)(l),[b,k]=(0,r.useState)(!1),[y,A]=(0,r.useState)(),[x,C]=f("file","jbrowse.svg"),[S,w]=f("theme",n.themeName||"default");return r.createElement(g.Dialog,{open:!0,onClose:t,title:"Export SVG"},r.createElement(i.A,null,y?r.createElement(g.ErrorMessage,{error:y}):b?r.createElement(p,null):null,r.createElement(E,{helperText:"filename",value:x,onChange:e=>C(e.target.value)}),n.allThemes?r.createElement(E,{select:!0,label:"Theme",value:S,onChange:e=>w(e.target.value)},Object.entries(n.allThemes()).map((([e,t])=>r.createElement(s.A,{key:e,value:e},t.name||"(Unknown name)")))):null,l?r.createElement(c.A,{control:r.createElement(m.A,{checked:o,onChange:()=>v((e=>!e))}),label:"Rasterize canvas based tracks? File may be much larger if this is turned off"}):r.createElement(a.A,null,"Note: rasterizing layers not yet supported in this browser, so SVG size may be large")),r.createElement(d.A,null,r.createElement(u.A,{variant:"contained",color:"secondary",onClick:()=>t()},"Cancel"),r.createElement(u.A,{variant:"contained",color:"primary",type:"submit",onClick:async()=>{k(!0),A(void 0);try{await e.exportSvg({rasterizeLayers:o,filename:x,themeName:S}),t()}catch(e){console.error(e),A(e)}finally{k(!1)}}},"Submit")))}},62516:(e,t,n)=>{n.d(t,{A:()=>g});var r=n(96540),l=n(44015),a=n(7562),o=n(13734),i=n(44675);const s=(0,n(44877).makeStyles)()({rulerLabel:{fontSize:"0.8rem",fontWeight:500,lineHeight:1.6,letterSpacing:"0.0075em"}});function c(e,t,n,r){e.flipped&&([n,r]=[r,n]);const l=e.bpToXY(n,t),a=e.bpToXY(r,t);return["M",...l,"A",t,t,"0",Math.abs(r-n)/e.bpPerRadian>Math.PI?"1":"0","1",...a].join(" ")}const m=(0,l.observer)((function({model:e,slice:t,region:n}){const l=(0,i.A)(),{radiusPx:o}=e,s=o+1,{endRadians:c,startRadians:m}=t,u=(0,a.polarToCartesian)(s,m),g=(0,a.polarToCartesian)(s,c),h=(c-m)*s,p=c-m>Math.PI?"1":"0",E=(c+m)/2,f=`[${Number(n.regions.length).toLocaleString()}]`;return r.createElement(r.Fragment,null,r.createElement(d,{text:f,view:e,maxWidthPx:h,radians:E,radiusPx:s,title:`${f} more regions`,color:l.palette.text.primary}),r.createElement("path",{d:["M",...u,"A",s,s,"0",p,"1",...g].join(" "),...(0,a.getStrokeProps)(l.palette.text.secondary),strokeWidth:2,strokeDasharray:"2,2",fill:"none"}))})),d=(0,l.observer)((function({view:e,text:t,maxWidthPx:n,radians:l,radiusPx:o,title:i,color:c}){const{classes:m}=s(),d=(0,a.polarToCartesian)(o+5,l);return t?6.5*t.length<n?r.createElement("text",{x:0,y:0,className:m.rulerLabel,textAnchor:"middle",dominantBaseline:"baseline",transform:`translate(${d}) rotate(${(0,a.radToDeg)(l)+90})`,...(0,a.getFillProps)(c)},t,r.createElement("title",null,i||t)):n>4?(0,a.radToDeg)(l+e.offsetRadians-Math.PI/2)>=180?r.createElement("text",{x:0,y:0,className:m.rulerLabel,textAnchor:"start",dominantBaseline:"middle",transform:`translate(${d}) rotate(${(0,a.radToDeg)(l)})`,fill:c},t,r.createElement("title",null,i||t)):r.createElement("text",{x:0,y:0,className:m.rulerLabel,textAnchor:"end",dominantBaseline:"middle",transform:`translate(${d}) rotate(${(0,a.radToDeg)(l)+180})`,fill:c},t,r.createElement("title",null,i||t)):null:null})),u=(0,l.observer)((function({model:e,slice:t,region:n}){const l=(0,i.A)(),{radiusPx:s}=e,{endRadians:m,startRadians:u}=t,g=(m+u)/2,h=(m-u)*s;let p;const E=(0,a.getSession)(e).assemblyManager.get(n.assemblyName);if(E&&(p=E.getRefNameColor(n.refName)),p)try{p=(0,o.makeContrasting)(p,l.palette.background.paper)}catch(e){p=l.palette.text.primary}else p=l.palette.text.primary;return r.createElement(r.Fragment,null,r.createElement(d,{text:n.refName,view:e,maxWidthPx:h,radians:g,radiusPx:s,color:p}),r.createElement("path",{d:c(t,s+1,n.start,n.end),stroke:p,strokeWidth:2,fill:"none"}))})),g=(0,l.observer)((function({model:e,slice:t}){return t.region.elided?r.createElement(m,{key:(0,a.assembleLocString)(t.region.regions[0]),model:e,region:t.region,slice:t}):r.createElement(u,{key:(0,a.assembleLocString)(t.region),region:t.region,model:e,slice:t})}))},29898:(e,t,n)=>{var r=n(24994);t.A=void 0;var l=r(n(42032)),a=n(74848);t.A=(0,l.default)((0,a.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1z"}),"Lock")},90022:(e,t,n)=>{var r=n(24994);t.A=void 0;var l=r(n(42032)),a=n(74848);t.A=(0,l.default)((0,a.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"}),"LockOpen")},36255:(e,t,n)=>{var r=n(24994);t.A=void 0;var l=r(n(42032)),a=n(74848);t.A=(0,l.default)((0,a.jsx)("path",{d:"M7.11 8.53 5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47M6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47m1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93"}),"RotateLeft")},98302:(e,t,n)=>{var r=n(24994);t.A=void 0;var l=r(n(42032)),a=n(74848);t.A=(0,l.default)((0,a.jsx)("path",{d:"M15.55 5.55 11 1v3.07C7.06 4.56 4 7.92 4 12s3.05 7.44 7 7.93v-2.02c-2.84-.48-5-2.94-5-5.91s2.16-5.43 5-5.91V10zM19.93 11c-.17-1.39-.72-2.73-1.62-3.89l-1.42 1.42c.54.75.88 1.6 1.02 2.47zM13 17.9v2.02c1.39-.17 2.74-.71 3.9-1.61l-1.44-1.44c-.75.54-1.59.89-2.46 1.03m3.89-2.42 1.42 1.41c.9-1.16 1.45-2.5 1.62-3.89h-2.02c-.14.87-.48 1.72-1.02 2.48"}),"RotateRight")}}]);