"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[2985],{42985:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var r=a(2340),s=a(11375),n=a(34105),i=a(31056),d=a(88482),o=a(26018),l=a(66061);class c extends r.BaseFeatureDataAdapter{async loadDataP(){const e=this.pluginManager,t=await(0,s.openLocation)(this.getConf("gffLocation"),e).readFile(),a=function(e){return 31===e[0]&&139===e[1]&&8===e[2]}(t)?await(0,o.unzip)(t):t;if(a.length>536870888)throw new Error("Data exceeds maximum string length (512MB)");const r=new TextDecoder("utf8",{fatal:!0}).decode(a),n=r.split(/\n|\r\n|\r/),c=[];for(let e=0;e<n.length&&n[e].startsWith("#");e++)c.push(n[e]);const f=c.join("\n"),u=l.default.parseStringSync(r,{parseFeatures:!0,parseComments:!1,parseDirectives:!1,parseSequences:!1,disableDerivesFromReferences:!0}),h={};for(const e of u.flat().map(((e,t)=>new d.default({data:this.featureData(e),id:`${this.id}-offset-${t}`})))){const t=e.get("refName");h[t]||(h[t]=new i.Ay),h[t].insert([e.get("start"),e.get("end")],e)}return{header:f,intervalTree:h}}async loadData(){return this.gffFeatures||(this.gffFeatures=this.loadDataP().catch((e=>{throw this.gffFeatures=void 0,e}))),this.gffFeatures}async getRefNames(e={}){const{intervalTree:t}=await this.loadData();return Object.keys(t)}async getHeader(){const{header:e}=await this.loadData();return e}getFeatures(e,t={}){return(0,n.ObservableCreate)((async t=>{var a;try{const{start:r,end:s,refName:n}=e,{intervalTree:i}=await this.loadData();null===(a=i[n])||void 0===a||a.search([r,s]).forEach((e=>t.next(e))),t.complete()}catch(e){t.error(e)}}),t.signal)}featureData(e){const t={...e};t.start-=1,"+"===e.strand?t.strand=1:"-"===e.strand?t.strand=-1:"."===e.strand?t.strand=0:t.strand=void 0,t.phase=Number(e.phase),t.refName=e.seq_id,null===e.score&&delete t.score,null===e.phase&&delete t.score;const a=new Set(["start","end","seq_id","score","type","source","phase","strand"]),r=e.attributes||{};for(const e of Object.keys(r)){let s=e.toLowerCase();if(a.has(s)&&(s+="2"),null!==r[e]){let a=r[e];Array.isArray(a)&&1===a.length&&([a]=a),t[s]=a}}return t.refName=t.seq_id,e.child_features&&e.child_features.length>0&&(t.subfeatures=e.child_features.flatMap((e=>e.map((e=>this.featureData(e)))))),delete t.child_features,delete t.data,delete t.attributes,delete t.seq_id,t}freeResources(){}}}}]);