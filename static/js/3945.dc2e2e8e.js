"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[3945],{96326:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var l=n(96540),r=n(44015),i=n(34339),a=n(26515),o=n(3822),s=n(33551),c=n(1043),d=n(1775),u=n(71238),m=n(60801),f=n(91089),p=n(7562),v=n(73085),h=n.n(v),E=n(23750);function g({columns:e,filter:t,setFilter:n}){return l.createElement(l.Fragment,null,l.createElement(s.A,null,"These filters can use a plain text search or regex style query, e.g. in the genotype field, entering 1 will query for all genotypes that include the first alternate allele e.g. 0|1 or 1|1, entering [1-9]\\d* will find any non-zero allele e.g. 0|2 or 2/33"),e.map((({field:e})=>l.createElement(c.A,{key:`filter-${e}`,placeholder:`Filter ${e}`,value:t[e]||"",onChange:l=>n({...t,[e]:l.target.value})}))))}function w(e){var t;const{feature:n,descriptions:r={}}=e,{ref:i,scrollLeft:o}=(0,E.useResizeBar)(),[c,v]=(0,l.useState)({}),w=n.samples||{},S=Object.entries(w);let b,y=[];const A=Object.keys(c);try{y=S.map((e=>({...Object.fromEntries(Object.entries(e[1]).map((e=>[e[0],`${e[1]}`]))),sample:e[0],id:e[0]}))).filter((e=>!A.length||A.every((t=>{const n=c[t];return!n||e[t].match(new RegExp(n,"i"))}))))}catch(e){b=e}const C=["sample",...Object.keys((null===(t=S[0])||void 0===t?void 0:t[1])||{})],[k,O]=(0,l.useState)(!1),[F,N]=(0,l.useState)(C.map((e=>(0,p.measureGridWidth)(y.map((t=>t[e])))))),$=C.map(((e,t)=>{var n,l;return{field:e,description:null===(l=null===(n=null==r?void 0:r.FORMAT)||void 0===n?void 0:n[e])||void 0===l?void 0:l.Description,width:F[t]}}));return S.length?l.createElement(a.BaseCard,{...e,title:"Samples"},b?l.createElement(s.A,{color:"error"},`${b}`):null,l.createElement(d.A,{control:l.createElement(u.A,{checked:k,onChange:e=>O(e.target.checked)}),label:l.createElement(s.A,{variant:"body2"},"Show options")}),k?l.createElement(g,{setFilter:v,columns:$,filter:c}):null,l.createElement("div",{ref:i},l.createElement(h(),{widths:F,setWidths:N,scrollLeft:o}),l.createElement(m.z,{rows:y,hideFooter:y.length<100,columns:$,disableRowSelectionOnClick:!0,rowHeight:25,columnHeaderHeight:35,disableColumnMenu:!0,slots:{toolbar:k?f.O:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}}}))):null}var S=n(90656);const b=(0,l.lazy)((()=>n.e(353).then(n.bind(n,353))));function y({locStrings:e,model:t}){const n=(0,p.getSession)(t);return l.createElement("div",null,l.createElement(s.A,null,"Link to linear view of breakend endpoints"),l.createElement("ul",null,e.map(((e,r)=>l.createElement("li",{key:`${e}-${r}`},l.createElement(S.A,{href:"#",onClick:l=>{var r;l.preventDefault();const{view:i}=t;try{if(!i)throw new Error("No view associated with this feature detail panel anymore");null===(r=i.navToLocString)||void 0===r||r.call(i,e)}catch(e){console.error(e),n.notify(`${e}`)}}},`LGV - ${e}`))))))}function A({locStrings:e,model:t,feature:n,viewType:r}){const i=(0,p.getSession)(t),a=new p.SimpleFeature(n);return l.createElement("div",null,l.createElement(s.A,null,"Launch split views with breakend source and target"),l.createElement("ul",null,e.map((e=>l.createElement("li",{key:`${JSON.stringify(e)}`},l.createElement(S.A,{href:"#",onClick:e=>{e.preventDefault(),i.queueDialog((e=>[b,{handleClose:e,model:t,feature:a,viewType:r}]))}},`${n.refName}:${n.start} // ${e} (split view)`))))))}function C(e){const{model:t,locStrings:n,feature:r}=e,i=(0,p.getSession)(t),{pluginManager:o}=(0,p.getEnv)(i);let s;try{s=o.getViewType("BreakpointSplitView")}catch(e){}return l.createElement(a.BaseCard,{...e,title:"Breakends"},l.createElement(y,{model:t,locStrings:n}),s?l.createElement(A,{viewType:s,model:t,locStrings:n,feature:r}):null)}function k({rows:e,columns:t}){const{ref:n,scrollLeft:r}=(0,E.useResizeBar)(),[i,a]=(0,l.useState)(!1),[o,c]=(0,l.useState)(t.map((t=>(0,p.measureGridWidth)(e.map((e=>e[t.field]))))));return e.length?l.createElement("div",{ref:n},l.createElement(d.A,{control:l.createElement(u.A,{checked:i,onChange:e=>a(e.target.checked)}),label:l.createElement(s.A,{variant:"body2"},"Show options")}),l.createElement("div",{ref:n},l.createElement(h(),{widths:o,setWidths:c,scrollLeft:r}),l.createElement(m.z,{rowHeight:25,rows:e,columns:t.map(((e,t)=>({...e,width:o[t]}))),slots:{toolbar:i?f.O:null}}))):null}function O({data:e,fields:t,title:n}){return e.length?l.createElement(a.BaseCard,{title:n},l.createElement(k,{rows:e.map(((e,n)=>({id:n,...Object.fromEntries(e.split("|").map(((e,n)=>[t[n],e])))})))||[],columns:t.map((e=>({field:e})))})):null}const F={CHROM:"chromosome: An identifier from the reference genome",POS:"position: The reference position, with the 1st base having position 1",ID:"identifier: Semi-colon separated list of unique identifiers where available",REF:"reference base(s): Each base must be one of A,C,G,T,N (case insensitive).",ALT:"alternate base(s): Comma-separated list of alternate non-reference alleles",QUAL:"quality: Phred-scaled quality score for the assertion made in ALT",FILTER:"filter status: PASS if this position has passed all filters, otherwise a semicolon-separated list of codes for filters that fail"};function N({descriptions:e,feature:t}){var n,r,i,a;const o=null===(r=null===(n=null==e?void 0:e.INFO)||void 0===n?void 0:n.ANN)||void 0===r?void 0:r.Description,s=(null===(i=null==o?void 0:o.match(/.*Functional annotations:'(.*)'$/))||void 0===i?void 0:i[1].split("|"))||[],c=(null===(a=t.INFO)||void 0===a?void 0:a.ANN)||[];return l.createElement(O,{fields:s,data:c,title:"Variant ANN field"})}function $({descriptions:e,feature:t}){var n,r,i,a;const o=null===(r=null===(n=null==e?void 0:e.INFO)||void 0===n?void 0:n.CSQ)||void 0===r?void 0:r.Description,s=(null===(i=null==o?void 0:o.match(/.*Format: (.*)/))||void 0===i?void 0:i[1].split("|"))||[],c=(null===(a=t.INFO)||void 0===a?void 0:a.CSQ)||[];return l.createElement(O,{fields:s,data:c,title:"Variant CSQ field"})}const T=(0,r.observer)((function(e){const{model:t}=e,{featureData:n,descriptions:r}=t,s=JSON.parse(JSON.stringify(n)),{samples:c,...d}=s;return l.createElement(i.A,{"data-testid":"variant-side-drawer"},l.createElement(a.FeatureDetails,{feature:d,descriptions:{...F,...r},...e}),l.createElement($,{feature:d,descriptions:r}),l.createElement(N,{feature:d,descriptions:r}),"breakend"===s.type?l.createElement(C,{feature:s,locStrings:s.ALT.map((e=>{var t;return(null===(t=(0,o.parseBreakend)(e))||void 0===t?void 0:t.MatePosition)||""})),model:t}):null,"translocation"===s.type?l.createElement(C,{feature:s,model:t,locStrings:[`${s.INFO.CHR2[0]}:${s.INFO.END}`]}):null,l.createElement(w,{feature:s,...e,descriptions:r}))}))}}]);