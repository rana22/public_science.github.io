"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[4136],{44136:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(98330),s=r(29008),n=r(2340),i=r(11375),c=r(34105),o=r(88482),u=r(59315),d=r(81160),l=r(20459);class f extends n.BaseFeatureDataAdapter{async configurePre(e){const t=this.pluginManager,r=new a.C({filehandle:(0,i.openLocation)(this.getConf("bigBedLocation"),t)}),n=await r.getHeader(e);return{bigbed:r,header:n,parser:new s.default({autoSql:n.autoSql})}}async configure(e){return this.cached||(this.cached=this.configurePre(e).catch((e=>{throw this.cached=void 0,e}))),this.cached}async getRefNames(e){const{header:t}=await this.configure(e);return Object.keys(t.refsByName)}async getHeader(e){const{parser:t,header:r}=await this.configure(e),{version:a,fileType:s}=r,{fields:n,...i}=t.autoSql;return{version:a,fileType:s,autoSql:{...i},fields:Object.fromEntries(n.map((({name:e,comment:t})=>[e,t])))}}getFeatures(e,t={}){const{signal:r}=t,a=this.getConf("scoreColumn");return(0,c.ObservableCreate)((async s=>{try{const{parser:n,bigbed:i}=await this.configure(t);(await i.getFeatureStream(e.refName,e.start,e.end,{signal:r,basesPerSpan:e.end-e.start})).pipe((0,u.U)(),(0,d.T)((t=>{const r=n.parseLine(`${e.refName}\t${t.start}\t${t.end}\t${t.rest}`,{uniqueId:t.uniqueId});if(void 0===t.uniqueId)throw new Error("invalid bbi feature");const{uniqueId:s,type:i,chromStart:c,chromStarts:u,blockStarts:d,blockCount:f,blockSizes:h,chromEnd:m,thickStart:p,thickEnd:b,chrom:k,score:S,...y}=r,N=f?(0,l.zZ)({chromStarts:u,blockStarts:d,blockCount:f,blockSizes:h,uniqueId:s,refName:e.refName,start:t.start}):[];return new o.default({id:`${this.id}-${s}`,data:(0,l.xD)(r)?(0,l.BX)({...y,uniqueId:s,type:i,start:t.start,end:t.end,refName:e.refName,score:a?+r[a]:S,chromStarts:u,blockCount:f,blockSizes:h,thickStart:p,thickEnd:b,subfeatures:N}):{...y,uniqueId:s,type:i,start:t.start,score:a?+r[a]:S,end:t.end,refName:e.refName,subfeatures:N}})}))).subscribe(s)}catch(e){s.error(e)}}),t.signal)}freeResources(){}}},20459:(e,t,r)=>{r.d(t,{BX:()=>s,dE:()=>i,xD:()=>c,zZ:()=>n});var a=r(7562);function s(e){var t;const{subfeatures:r,thickStart:a,thickEnd:s,blockCount:n,blockSizes:i,chromStarts:c,refName:o,strand:u=0,...d}=e;if(!a||!s||!u)return e;const l=[];return null===(t=r.filter((e=>"block"===e.type)).sort(((e,t)=>e.start-t.start)))||void 0===t||t.forEach((e=>{const t=e.start,r=e.end;if(a>=r){const e=u>0?"five":"three";l.push({type:`${e}_prime_UTR`,start:t,end:r,refName:o})}else if(a>t&&a<r&&s>=r){const e=u>0?"five":"three";l.push({type:`${e}_prime_UTR`,start:t,end:a,refName:o},{type:"CDS",start:a,end:r,refName:o})}else if(a<=t&&s>=r)l.push({type:"CDS",start:t,end:r,refName:o});else if(a>t&&a<r&&s<r){const e=u>0?"five":"three",n=u>0?"three":"five";l.push({type:`${e}_prime_UTR`,start:t,end:a,refName:o},{type:"CDS",start:a,end:s,refName:o},{type:`${n}_prime_UTR`,start:s,end:r,refName:o})}else if(a<=t&&s>t&&s<r){const e=u>0?"three":"five";l.push({type:"CDS",start:t,end:s,refName:o},{type:`${e}_prime_UTR`,start:s,end:r,refName:o})}else if(s<=t){const e=u>0?"three":"five";l.push({type:`${e}_prime_UTR`,start:t,end:r,refName:o})}})),{...d,strand:u,type:"mRNA",refName:o,subfeatures:l}}function n({start:e,uniqueId:t,refName:r,chromStarts:a,blockCount:s,blockSizes:n,blockStarts:i}){const c=[],o=a||i||[];for(let a=0;a<s;a++){const s=(o[a]||0)+e,i=s+((null==n?void 0:n[a])||0);c.push({uniqueId:`${t}-${a}`,start:s,end:i,refName:r,type:"block"})}return c}function i(e,t,r,i,o,u,d,l){const f=e.split("\t"),h=f[t],m=+f[r],p=r===i?1:0,b=+f[i]+p,k=l?function(e,t){const{blockStarts:r,blockCount:a,chromStarts:s,thickEnd:n,thickStart:i,blockSizes:c,...o}=Object.fromEntries(t.split("\t").map(((t,r)=>[e[r],t])));return{...o,blockStarts:null==r?void 0:r.split(",").map((e=>+e)),chromStarts:null==s?void 0:s.split(",").map((e=>+e)),blockSizes:null==c?void 0:c.split(",").map((e=>+e)),thickStart:+i,thickEnd:+n,blockCount:+a}}(l,e):u.parseLine(e,{uniqueId:d}),{blockCount:S,blockSizes:y,blockStarts:N,chromStarts:C,thickStart:g,thickEnd:v,type:q,score:w,chrom:E,chromStart:I,chromEnd:$,..._}=k,z=S?n({start:m,uniqueId:d,refName:h,chromStarts:C,blockCount:S,blockSizes:y,blockStarts:N}):[],D={..._,type:q,score:o?+k[o]:w,start:m,end:b,refName:h,uniqueId:d,subfeatures:z};return new a.SimpleFeature({id:d,data:c(k)?s({thickStart:g,thickEnd:v,blockCount:S,blockSizes:y,chromStarts:C,...D}):D})}function c(e){return e.thickStart&&e.blockCount&&0!==e.strand}}}]);