"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[7804],{47804:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h,featureData:()=>c});var s=a(2340),r=a(11375),n=a(34105),i=a(7562),o=a(31056),l=a(26018);function c(e,t,a,s){const r=e.split("\t"),n=r[a?3:0],o=+r[a?4:1],l=+r[a?5:2],c=r[a?0:3],d=+r[a?1:4],h=+r[a?2:5],f=r[6],p=+r[7],m=u(r[8]),g=u(r[9]),v=r.slice(10),w=s?Object.fromEntries(s.slice(10).map(((e,t)=>[e,v[t]]))):v;let D;return["DUP","TRA","INV","CNV","DEL"].includes(v[0])&&(D=`<${v[0]}>`),new i.SimpleFeature({start:o,end:l,refName:n,...D?{ALT:[D]}:{},strand:m,name:f,...w,score:p,uniqueId:t,mate:{refName:c,start:d,end:h,strand:g}})}function u(e){return"+"===e?1:"-"===e?-1:"."===e?0:void 0}class d extends s.BaseFeatureDataAdapter{constructor(){super(...arguments),this.intervalTrees={}}async loadDataP(e={}){const t=this.pluginManager,a=this.getConf("bedpeLocation"),s=await(0,r.openLocation)(a,t).readFile(e),n=function(e){return 31===e[0]&&139===e[1]&&8===e[2]}(s)?await(0,l.unzip)(s):s;if(n.length>536870888)throw new Error("Data exceeds maximum string length (512MB)");const i=new TextDecoder("utf8",{fatal:!0}).decode(n).split(/\n|\r\n|\r/).filter((e=>!!e)),o=[];let c=0;for(;c<i.length&&i[c].startsWith("#");c++)o.push(i[c]);const u=o.join("\n"),d={},h={};for(;c<i.length;c++){const e=i[c],t=e.split("\t"),a=t[0],s=t[3];d[a]||(d[a]=[]),h[s]||(h[s]=[]),d[a].push(e),h[s].push(e)}return{header:u,feats1:d,feats2:h,columnNames:this.getConf("columnNames")}}async loadData(e={}){return this.bedpeFeatures||(this.bedpeFeatures=this.loadDataP(e).catch((e=>{throw this.bedpeFeatures=void 0,e}))),this.bedpeFeatures}async getRefNames(e={}){const{feats1:t,feats2:a}=await this.loadData(e);return[...new Set([...Object.keys(t),...Object.keys(a)])]}async getHeader(e={}){const{header:t}=await this.loadData(e);return t}async getNames(){const{header:e,columnNames:t}=await this.loadData();if(t.length)return t;const a=e.split(/\n|\r\n|\r/).filter((e=>!!e)).at(-1);return(null==a?void 0:a.includes("\t"))?a.slice(1).split("\t").map((e=>e.trim())):void 0}async loadFeatureTreeP(e){var t,a,s,r;const{feats1:n,feats2:i}=await this.loadData(),l=await this.getNames(),u=new o.Ay,d=null!==(a=null===(t=n[e])||void 0===t?void 0:t.map(((t,a)=>c(t,`${this.id}-${e}-${a}-r1`,!1,l))))&&void 0!==a?a:[],h=null!==(r=null===(s=i[e])||void 0===s?void 0:s.map(((t,a)=>c(t,`${this.id}-${e}-${a}-r2`,!0,l))))&&void 0!==r?r:[];for(const e of[...d,...h])u.insert([e.get("start"),e.get("end")],e);return u}async loadFeatureTree(e){return this.intervalTrees[e]||(this.intervalTrees[e]=this.loadFeatureTreeP(e).catch((t=>{throw this.intervalTrees[e]=void 0,t}))),this.intervalTrees[e]}getFeatures(e,t={}){return(0,n.ObservableCreate)((async t=>{const{start:a,end:s,refName:r}=e,n=await this.loadFeatureTree(r);null==n||n.search([a,s]).forEach((e=>t.next(e))),t.complete()}),t.signal)}freeResources(){}}d.capabilities=["getFeatures","getRefNames"];const h=d}}]);