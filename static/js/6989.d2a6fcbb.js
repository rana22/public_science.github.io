"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[6989],{75166:(e,t)=>{t.UU=void 0,t.UU=function(e){return e.map((e=>{return`>${e.header}\n${t=e.seq,t.replaceAll(/(.{1,80})/g,"$1\n").trimEnd()}`;var t})).join("\n")}},6989:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var r=n(96540),o=n(44877),a=n(30799),l=n(33551),s=n(97834),c=n(78717),i=n(1043),u=n(22079),m=n(1775),d=n(71238),f=n(37071),g=n(51629),h=n(44015),b=n(4213),p=n(92168),A=n(17965),C=n.n(A),E=n(20212),v=n(7562),w=n(75166),y=n(54054),S=n(69372);const q=(0,o.makeStyles)()({dialogContent:{width:"80em"},textAreaFont:{fontFamily:"Courier New"}}),k=(0,h.observer)((function({model:e,handleClose:t}){const{classes:n}=q(),o=(0,v.getSession)(e),[h,A]=(0,r.useState)(),[k,$]=(0,r.useState)(),[x,F]=(0,r.useState)(!1),[N,R]=(0,r.useState)(!1),[I,O]=(0,r.useState)(!1),{leftOffset:U,rightOffset:D}=e,M=Boolean(void 0===k);(0,r.useEffect)((()=>{let t=!0;const n=new AbortController;return(async()=>{try{const r=e.getSelectedRegions(U,D);if(0===r.length)throw new Error("Selected region is out of bounds");const o=await async function(e,t,n){const r=(0,v.getSession)(e),{leftOffset:o,rightOffset:a}=e;if(!o||!a)throw new Error("no offsets on model to use for range");if(o.assemblyName!==a.assemblyName)throw new Error("not able to fetch sequences from multiple assemblies");const{rpcManager:l,assemblyManager:s}=r,c=o.assemblyName||a.assemblyName||"",i=s.get(c);if(!i)throw new Error(`assembly ${c} not found`);const u=(0,p.getConf)(i,["sequence","adapter"]),m="getSequence";return l.call(m,"CoreGetFeatures",{adapterConfig:u,regions:t,sessionId:m,signal:n})}(e,r,n.signal);t&&$(o)}catch(e){console.error(e),t&&A(e)}})(),()=>{n.abort(),t=!1}}),[e,o,U,D]);const _=k?(0,w.UU)(k.filter((e=>!!e)).map((e=>{let t=e.get("seq");const n=e.get("refName"),r=e.get("start")+1,o=e.get("end"),a=`${n}:${r}-${o}`;if((null==t?void 0:t.length)!==o-r+1)throw new Error(`${a} returned ${t.length.toLocaleString()} bases, but should have returned ${(o-r).toLocaleString()}`);return x&&(t=(0,v.reverse)(t)),I&&(t=(0,v.complement)(t)),{header:a+(x?"-rev":"")+(I?"-comp":""),seq:t}}))):"",j=!!_&&_.length>1e6;return r.createElement(E.Dialog,{maxWidth:"xl",open:!0,onClose:()=>{t(),e.setOffsets()},title:"Reference sequence"},r.createElement(a.A,null,h?r.createElement(l.A,{color:"error"},`${h}`):M?r.createElement(s.A,null,"Retrieving reference sequence...",r.createElement(c.A,{style:{marginLeft:10},size:20,disableShrink:!0})):null,r.createElement(i.A,{"data-testid":"rubberband-sequence",variant:"outlined",multiline:!0,minRows:5,maxRows:10,disabled:j,className:n.dialogContent,fullWidth:!0,value:j?"Reference sequence too large to display, use the download FASTA button":_,InputProps:{readOnly:!0,classes:{input:n.textAreaFont}}}),r.createElement(u.A,null,r.createElement(m.A,{control:r.createElement(d.A,{value:x,onChange:e=>F(e.target.checked)}),label:"Reverse sequence"}),r.createElement(m.A,{control:r.createElement(d.A,{value:I,onChange:e=>O(e.target.checked)}),label:"Complement sequence"})),r.createElement(l.A,{style:{margin:10}},'Note: Check both boxes for the "reverse complement"')),r.createElement(f.A,null,r.createElement(g.A,{onClick:()=>{C()(_),R(!0),setTimeout((()=>R(!1)),500)},disabled:M||!!h||j,color:"primary",startIcon:r.createElement(y.ContentCopy,null)},N?"Copied":"Copy to clipboard"),r.createElement(g.A,{onClick:()=>{(0,b.saveAs)(new Blob([_||""],{type:"text/x-fasta;charset=utf-8"}),"jbrowse_ref_seq.fa")},disabled:M||!!h,color:"primary",startIcon:r.createElement(S.A,null)},"Download FASTA"),r.createElement(g.A,{onClick:t,variant:"contained"},"Close")))}))},69372:(e,t,n)=>{var r=n(24994);t.A=void 0;var o=r(n(42032)),a=n(74848);t.A=(0,o.default)((0,a.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"GetApp")}}]);