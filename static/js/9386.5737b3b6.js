"use strict";(self.webpackChunkICDC_Frontend=self.webpackChunkICDC_Frontend||[]).push([[9386],{79386:(t,e,o)=>{o.d(e,{drawFeats:()=>c});var a=o(7562),n=o(60604),s=o(92168);function f(t,e,o,a,n,s){o<0&&(t+=o,o=-o),a<0&&(e+=a,a=-a),s&&(n.fillStyle=s),n.fillRect(t,e,o,a)}function i(t,e,o,a,n,s){o<0&&(t+=o,o=-o),a<0&&(e+=a,a=-a),s&&(n.strokeStyle=s),n.strokeRect(t,e,o,a)}var r=o(20709);function d({type:t,v0:e,v1:o,stats:a}){if("insertSizeAndOrientation"===t)return(0,r.sY)(e,o,a);if("orientation"===t)return(0,r.DW)(e);if("insertSize"===t)return(0,r.L9)(e,o,a);if("gradient"===t){const t=Math.min(e.start,o.start),a=Math.max(e.end,o.end);return[`hsl(${10*Math.log10(Math.abs(a-t))},50%,50%)`,`hsl(${10*Math.log10(Math.abs(a-t))},50%,30%)`]}}function c(t,e){const{chainData:o}=t;if(!o)return;const{assemblyManager:c}=(0,a.getSession)(t),l=(0,a.getContainingView)(t),m=l.assemblyNames[0],v=c.get(m);v&&((0,n.d)(o)?function({ctx:t,self:e,chainData:o,view:n,asm:r}){var c,l,m,v,h,x,u;const N=[],g=(0,s.getConf)(e,"featureHeight"),P=(null===(c=e.colorBy)||void 0===c?void 0:c.type)||"insertSizeAndOrientation",{chains:M,stats:p}=o;for(const o of M)if(o.length>1){const t=o[0],e=o[1],a=r.getCanonicalRefName(t.refName)||t.refName,s=r.getCanonicalRefName(e.refName)||e.refName,f=null===(l=n.bpToPx({refName:a,coord:t.start}))||void 0===l?void 0:l.offsetPx,i=null===(m=n.bpToPx({refName:a,coord:t.end}))||void 0===m?void 0:m.offsetPx,d=null===(v=n.bpToPx({refName:s,coord:e.start}))||void 0===v?void 0:v.offsetPx,c=null===(h=n.bpToPx({refName:s,coord:e.end}))||void 0===h?void 0:h.offsetPx;let x=0;if(void 0!==f&&void 0!==i&&void 0!==d&&void 0!==c){if(t.refName===e.refName){const o=Math.min(t.start,e.start),a=Math.max(t.end,e.end);x=Math.abs(a-o)}N.push({r1s:f,r1e:i,r2s:d,r2e:c,v0:t,v1:e,distance:x})}}else if(e.drawSingletons){const e=o[0],a=r.getCanonicalRefName(e.refName)||e.refName,s=null===(x=n.bpToPx({refName:a,coord:e.start}))||void 0===x?void 0:x.offsetPx,d=null===(u=n.bpToPx({refName:a,coord:e.end}))||void 0===u?void 0:u.offsetPx;if(void 0!==s&&void 0!==d){const e=Math.max(d-s,2);f(s-n.offsetPx,0,e,g,t,"#f00"),i(s-n.offsetPx,0,e,g,t,"#a00")}}const b=Math.log((0,a.max)(N.map((t=>t.distance)))),C=Math.max(Math.log((0,a.min)(N.map((t=>t.distance))))-1,0),w=(e.height-20)/(b-C);for(const{r1e:e,r1s:o,r2e:a,r2s:s,distance:r,v0:c,v1:l}of N){const m=Math.max(e-o,2),v=Math.max(a-s,2),[h,x]=d({type:P,v0:c,v1:l,stats:p})||[],u=(Math.log(r)-C)*w,N=g/2-.5,M=s-e;f(e-n.offsetPx,u+N,M,1,t,"black"),i(o-n.offsetPx,u,m,g,t,x),i(s-n.offsetPx,u,v,g,t,x),f(o-n.offsetPx,u,m,g,t,h),f(s-n.offsetPx,u,v,g,t,h)}}({self:t,view:l,asm:v,ctx:e,chainData:o}):function({ctx:t,self:e,chainData:o,view:n,asm:d}){var c,l,m,v,h;const x=[],u=[],{chains:N}=o,{height:g}=e,P=(0,s.getConf)(e,"featureHeight");for(const t of N){let e=Number.MAX_VALUE,o=Number.MIN_VALUE;for(const a of t){const t=d.getCanonicalRefName(a.refName)||a.refName,s=null===(c=n.bpToPx({refName:t,coord:a.start}))||void 0===c?void 0:c.offsetPx,f=null===(l=n.bpToPx({refName:t,coord:a.end}))||void 0===l?void 0:l.offsetPx;void 0!==s&&void 0!==f&&(e=Math.min(e,s),o=Math.max(o,f))}const a=Math.abs(o-e);x.push(a),u.push(e)}const M=Math.log((0,a.max)(x)),p=Math.max(Math.log((0,a.min)(x))-1,0),b=(g-20)/(M-p),C=P/2-.5;for(let e=0;e<N.length;e++){const o=N[e],a=x[e],s=(Math.log(a)-p)*b;f(u[e]-n.offsetPx,s+C,a,1,t,"black");const c=o[0];let l;l=2048&c.flags?"-"===(null===(m=c.SA)||void 0===m?void 0:m.split(";")[0].split(",")[2])?-1:1:c.strand;for(const e of o){const o=d.getCanonicalRefName(e.refName)||e.refName,a=null===(v=n.bpToPx({refName:o,coord:e.start}))||void 0===v?void 0:v.offsetPx,c=null===(h=n.bpToPx({refName:o,coord:e.end}))||void 0===h?void 0:h.offsetPx;if(void 0!==a&&void 0!==c){const o=Math.max(c-a,2),d=a-n.offsetPx,m=-1==e.strand*l?"color_rev_strand":"color_fwd_strand";i(d,s,o,P,t,r.w7[m]),f(d,s,o,P,t,r.pf[m])}}}}({self:t,view:l,asm:v,ctx:e,chainData:o}))}},60604:(t,e,o)=>{function a(t){for(const e of t.chains.values())if(1&e[0].flags)return!0;return!1}o.d(e,{d:()=>a})}}]);